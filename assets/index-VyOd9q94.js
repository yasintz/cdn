import{r as g,j as x,a as i}from"./index-PRTzKQHk.js";import{g as k,e as H}from"./coordinate-EYwYFw-a.js";import{_ as w}from"./lodash-J_05GX2t.js";const $=({help:t,children:a,onChange:n,disabled:r})=>{const l=o=>{const f=o.target.value;if(f.includes(",")){const{latitude:v,longitude:S}=k(f);n==null||n({...t,coordinate:{latitude:v,longitude:S}})}else n==null||n({...t,coordinate:{...t.coordinate,latitude:parseFloat(o.target.value)}})},s=o=>{n==null||n({...t,index:parseInt(o.target.value,10)})},d=o=>{n==null||n({...t,coordinate:{...t.coordinate,longitude:parseFloat(o.target.value)}})};return x("div",{children:[i("input",{placeholder:"index",value:t.index,onChange:s,disabled:r}),i("input",{placeholder:"cord",value:t.coordinate.latitude,onChange:l,disabled:r}),i("input",{value:t.coordinate.longitude,onChange:d,disabled:r}),i("input",{value:`${t.coordinate.latitude}, ${t.coordinate.longitude}`,disabled:r}),a]})},y={index:"",coordinate:{latitude:"",longitude:""}},A=()=>{const[t,a]=g.useState([]),[n,r]=g.useState(y),[l,s]=g.useState(),[d,o]=g.useState([]),f=t.find(e=>e.index===l);g.useEffect(()=>{const e=JSON.parse(localStorage.getItem("helps")||"[]");a(e)},[]);const h=()=>{if(n){const e=w.sortBy([...t,n],"index");a(e),r(y),localStorage.setItem("helps",JSON.stringify(e))}},v=e=>{const c=t.filter(u=>u!==e);a(c),localStorage.setItem("helps",JSON.stringify(c))},S=()=>{const e=[],c=[];for(let u=0;u<t.length;u++){const p=t[u];if(e.includes(p.index))continue;const I=p.distanceToOthers.filter(m=>m.distance<1500).map(m=>m.index).filter(m=>!e.includes(m));e.push(...I,p.index),c.push([p.index,...I])}o(c),console.log(c)};return x("div",{style:{display:"flex"},children:[x("pre",{children:["Title,latitude,longitude,Address",`
`,t.map(e=>`${e.index},${e.coordinate.latitude},${e.coordinate.longitude},"[${e.coordinate.latitude},${e.coordinate.longitude}]"`).join(`
`)]}),x("div",{children:[i("button",{onClick:S,children:"Refresh"}),t.map(e=>x($,{help:e,disabled:!0,children:[i("button",{onClick:()=>v(e),children:"x"}),i("button",{onClick:()=>s(e.index),children:">"})]},e.index)),i($,{onChange:e=>r(e),help:n,children:i("button",{onClick:h,children:"Add"})}),j(t).map(e=>i("div",{children:i("a",{href:e.url,target:"_blank",children:e.routes.map(c=>c.index).join(", ")})})),i("div",{children:d.map((e,c)=>x("div",{children:[i("div",{children:e.join(", ")}),i("a",{href:j(e.map(u=>t.find(p=>p.index===u))).toString(),target:"_blank",children:"Direction"}),i("hr",{})]},c.toString()))})]}),f&&i("div",{children:i("pre",{children:JSON.stringify(f,null,2)})})]})},j=t=>{if(t.length===0)return[];const a=k("37.076498222032924,37.32748232296175"),n=Array.from(t),r=[t[0]];console.log(r);let l=r[0];for(;l;){const s=w.sortBy(n.map(o=>({...o,distance:H.getDistance(l.coordinate,o.coordinate)})),"distance")[0],d=n.findIndex(o=>o.index===s.index);d!=-1?(n.splice(d,1),r.push(s),l=s):l=void 0}return w.chunk(r,7).map(s=>({routes:s,url:`https://www.google.com/maps/dir/${s.map(d=>d.coordinate).reverse().concat([a]).reverse().map(d=>`${d.latitude},${d.longitude}`).join("/")}`}))};export{A as default};
