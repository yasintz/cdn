<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <style>
      body {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        height: 100vh;
      }
      * {
        margin-bottom: 20px;
      }
    </style>
  </head>
  <body>
    <input type="text" maxlength="5" id="input" />
    <button id="send" onclick="$send()">Gonder</button>
    <button id="clear" onclick="$clear()">Temizle</button>

    <script>
      const API_URL = ' https://api.npoint.io/4aab6a5e7a2ec2d31ab5';

      let cache = [];
      function publish() {
        return fetch(API_URL, {
          method: 'POST',
          headers: {
            Accept: 'application/json, text/plain, */*',
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(cache),
        }).then(() => {
          input.value = '';
          alert('Islem Basarili');
        });
      }

      fetch(API_URL)
        .then((res) => res.json())
        .then((json) => {
          cache = json;
        });

      const input = document.getElementById('input');
      function $send() {
        const text = input.value;
        if (text.length !== 5) {
          alert('5 karakterli bir yazi yazin');
          return;
        }
        cache.push(text);
        publish();
      }
      function $clear() {
        console.log('working');
        cache = [];
        publish();
      }
    </script>
  </body>
</html>
